<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>HTMLBars Test Suite</title>
  <link rel="stylesheet" href="qunit.css">
</head>
<body>
  <div id="qunit"></div>
  <div id="qunit-fixture"></div>
  <script src="qunit.js"></script>
  <script src="/testem.js"></script>
  <script src="../assets/loader.js"></script>
  <script>loader.noConflict({ define: 'enifed' });</script>
  <!--<script src="export-test-results.js"></script>-->
  <script src="/amd/glimmer-compiler.amd.js"></script>
  <script src="/tests.js"></script>

  <script>
    QUnit.config.urlConfig.push({ id: 'nojshint', label: "No JSHint"});

    function injectScript(url) {
      document.write(unescape('%3Cscript src="'+url+'"%3E%3C/script%3E'));
    }

    function injectTests(packageName) {
      injectScript(packageName + "-tests.amd.js");
    }

    function keys(o) {
      var arr = [];
      for (var k in o) {
        arr.push(k);
      }
      return arr;
    }

    function getPackagesToTest() {
      if (QUnit.urlParams.packages) {
        return QUnit.urlParams.packages.split(',');
      }
    }

    // Recursively merge all the dependencies for this configuration of
    // packages to ensure that we only inject each dependency once.
    // Testing dependencies are only injected for the packages being tested.
    var packagesToTest = getPackagesToTest();
  </script>

  <script>
    var testMatch;
    if (packagesToTest) {
      testMatch = new RegExp("^(" + packagesToTest.join("|") + ").*-test$");
    } else {
      testMatch = /\-test$/;
    }
    
    Object.keys(requireModule.entries).forEach(function(entry) {
      if (entry.match(testMatch)) requireModule(entry);
    });
  </script>
</body>
</html>
