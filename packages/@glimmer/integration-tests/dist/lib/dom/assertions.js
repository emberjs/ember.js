import { dict, assign } from '@glimmer/util';
function isDebugElement(el) {
    return !el.nodeType;
}
function extract(element) {
    if (element === null) {
        return { element: null, description: 'element' };
    }
    else if (isDebugElement(element)) {
        return element;
    }
    else {
        return { element, description: 'element' };
    }
}
export function equalsElement(input, tagName, attributes, content) {
    let { element, description } = extract(input);
    if (element === null) {
        QUnit.assert.pushResult({
            result: false,
            actual: element,
            expected: true,
            message: `failed - expected ${description} to not be null`,
        });
        return;
    }
    QUnit.assert.pushResult({
        result: element.tagName === tagName.toUpperCase(),
        actual: element.tagName.toLowerCase(),
        expected: tagName,
        message: `expect ${description}'s tagName to be ${tagName}`,
    });
    let expectedAttrs = dict();
    let expectedCount = 0;
    for (let prop in attributes) {
        expectedCount++;
        let expected = attributes[prop];
        let matcher = isMatcher(expected) ? expected : equalsAttr(expected);
        expectedAttrs[prop] = matcher;
        QUnit.assert.pushResult({
            result: expectedAttrs[prop].match(element && element.getAttribute(prop)),
            actual: matcher.fail(element && element.getAttribute(prop)),
            expected: matcher.fail(element && element.getAttribute(prop)),
            message: `Expected ${description}'s ${prop} attribute ${matcher.expected()}`,
        });
    }
    let actualAttributes = dict();
    if (element) {
        for (let i = 0, l = element.attributes.length; i < l; i++) {
            actualAttributes[element.attributes[i].name] = element.attributes[i].value;
        }
    }
    if (!(element instanceof HTMLElement)) {
        QUnit.assert.pushResult({
            result: element instanceof HTMLElement,
            actual: null,
            expected: null,
            message: 'Element must be an HTML Element, not an SVG Element',
        });
    }
    else {
        QUnit.assert.pushResult({
            result: element.attributes.length === expectedCount,
            actual: element.attributes.length,
            expected: expectedCount,
            message: `Expected ${expectedCount} attributes; got ${element.outerHTML}`,
        });
        if (content !== null) {
            QUnit.assert.pushResult({
                result: element.innerHTML === content,
                actual: element.innerHTML,
                expected: content,
                message: `${description} had '${content}' as its content`,
            });
        }
    }
}
export function assertIsElement(node) {
    let nodeType = node === null ? null : node.nodeType;
    QUnit.assert.pushResult({
        result: nodeType === 1,
        expected: 1,
        actual: nodeType,
        message: 'expected node to be an element',
    });
    return nodeType === 1;
}
export function assertNodeTagName(node, tagName) {
    if (assertIsElement(node)) {
        const lowerTagName = node.tagName.toLowerCase();
        const nodeTagName = node.tagName;
        QUnit.assert.pushResult({
            result: lowerTagName === tagName || nodeTagName === tagName,
            expected: tagName,
            actual: nodeTagName,
            message: `expected tagName to be ${tagName} but was ${nodeTagName}`,
        });
        return nodeTagName === tagName || lowerTagName === tagName;
    }
    return false;
}
export function equalsAttr(expected) {
    return {
        '3d4ef194-13be-4ccf-8dc7-862eea02c93e': true,
        match(actual) {
            return expected === actual;
        },
        expected() {
            return `to equal ${expected}`;
        },
        fail(actual) {
            return `${actual} did not equal ${expected}`;
        },
    };
}
export function assertEmberishElement(...args) {
    let [element, tagName, attrs, contents] = processAssertElementArgs(args);
    let fullAttrs = assign({ class: classes('ember-view'), id: regex(/^ember\d*$/) }, attrs);
    equalsElement(element, tagName, fullAttrs, contents);
}
export function assertSerializedInElement(result, expected, message) {
    let matched = result.match(/<script glmr="%cursor:[0-9]*.%"><\/script>/);
    if (matched) {
        QUnit.assert.ok(true, `has cursor ${matched[0]}`);
        let [, trimmed] = result.split(matched[0]);
        QUnit.assert.equal(trimmed, expected, message);
    }
    else {
        QUnit.assert.ok(false, `does not have a cursor`);
    }
}
export function classes(expected) {
    return {
        '3d4ef194-13be-4ccf-8dc7-862eea02c93e': true,
        match(actual) {
            return (actual &&
                expected
                    .split(' ')
                    .sort()
                    .join(' ') ===
                    actual
                        .split(' ')
                        .sort()
                        .join(' '));
        },
        expected() {
            return `to include '${expected}'`;
        },
        fail(actual) {
            return `'${actual}'' did not match '${expected}'`;
        },
    };
}
export function regex(r) {
    return {
        '3d4ef194-13be-4ccf-8dc7-862eea02c93e': true,
        match(v) {
            return r.test(v);
        },
        expected() {
            return `to match ${r}`;
        },
        fail(actual) {
            return `${actual} did not match ${r}`;
        },
    };
}
export const MATCHER = '3d4ef194-13be-4ccf-8dc7-862eea02c93e';
export function isMatcher(input) {
    if (typeof input !== 'object' || input === null)
        return false;
    return MATCHER in input;
}
/**
  Accomodates the various signatures of `assertEmberishElement` and `assertElement`, which can be any of:

  - element, tagName, attrs, contents
  - element, tagName, contents
  - element, tagName, attrs
  - element, tagName

  TODO: future refactorings should clean up this interface (likely just making all callers pass a POJO)
*/
export function processAssertElementArgs(args) {
    let element = args[0];
    if (args.length === 3) {
        if (typeof args[2] === 'string')
            return [element, args[1], {}, args[2]];
        else
            return [element, args[1], args[2], null];
    }
    else if (args.length === 2) {
        return [element, args[1], {}, null];
    }
    else {
        return [args[0], args[1], args[2], args[3]];
    }
}
export function assertElementShape(...args) {
    let [element, tagName, attrs, contents] = processAssertElementArgs(args);
    equalsElement(element, tagName, attrs, contents);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZXJ0aW9ucy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9kb20vYXNzZXJ0aW9ucy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQU83QyxTQUFTLGNBQWMsQ0FBQyxFQUFnQztJQUN0RCxPQUFPLENBQUUsRUFBVyxDQUFDLFFBQVEsQ0FBQztBQUNoQyxDQUFDO0FBRUQsU0FBUyxPQUFPLENBQUMsT0FBc0I7SUFDckMsSUFBSSxPQUFPLEtBQUssSUFBSSxFQUFFO1FBQ3BCLE9BQU8sRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQUUsQ0FBQztLQUNsRDtTQUFNLElBQUksY0FBYyxDQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQ2xDLE9BQU8sT0FBTyxDQUFDO0tBQ2hCO1NBQU07UUFDTCxPQUFPLEVBQUUsT0FBTyxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQUUsQ0FBQztLQUM1QztBQUNILENBQUM7QUFJRCxNQUFNLFVBQVUsYUFBYSxDQUMzQixLQUFvQixFQUNwQixPQUFlLEVBQ2YsVUFBZ0IsRUFDaEIsT0FBc0I7SUFFdEIsSUFBSSxFQUFFLE9BQU8sRUFBRSxXQUFXLEVBQUUsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7SUFFOUMsSUFBSSxPQUFPLEtBQUssSUFBSSxFQUFFO1FBQ3BCLEtBQUssQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDO1lBQ3RCLE1BQU0sRUFBRSxLQUFLO1lBQ2IsTUFBTSxFQUFFLE9BQU87WUFDZixRQUFRLEVBQUUsSUFBSTtZQUNkLE9BQU8sRUFBRSxxQkFBcUIsV0FBVyxpQkFBaUI7U0FDM0QsQ0FBQyxDQUFDO1FBQ0gsT0FBTztLQUNSO0lBRUQsS0FBSyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUM7UUFDdEIsTUFBTSxFQUFFLE9BQU8sQ0FBQyxPQUFPLEtBQUssT0FB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c2ltcGxlLWRvbS9pbnRlcmZhY2UnO1xuaW1wb3J0IHsgRGljdCB9IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgZGljdCwgYXNzaWduIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGVidWdFbGVtZW50IHtcbiAgZWxlbWVudDogU2ltcGxlRWxlbWVudCB8IG51bGw7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG59XG5cbmZ1bmN0aW9uIGlzRGVidWdFbGVtZW50KGVsOiBTaW1wbGVFbGVtZW50IHwgRGVidWdFbGVtZW50KTogZWwgaXMgRGVidWdFbGVtZW50IHtcbiAgcmV0dXJuICEoZWwgYXMgRGljdCkubm9kZVR5cGU7XG59XG5cbmZ1bmN0aW9uIGV4dHJhY3QoZWxlbWVudDogRXF1YWxzRWxlbWVudCk6IERlYnVnRWxlbWVudCB7XG4gIGlmIChlbGVtZW50ID09PSBudWxsKSB7XG4gICAgcmV0dXJuIHsgZWxlbWVudDogbnVsbCwgZGVzY3JpcHRpb246ICdlbGVtZW50JyB9O1xuICB9IGVsc2UgaWYgKGlzRGVidWdFbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHsgZWxlbWVudCwgZGVzY3JpcHRpb246ICdlbGVtZW50JyB9O1xuICB9XG59XG5cbmV4cG9ydCB0eXBlIEVxdWFsc0VsZW1lbnQgPSBTaW1wbGVFbGVtZW50IHwgbnVsbCB8IERlYnVnRWxlbWVudDtcblxuZXhwb3J0IGZ1bmN0aW9uIGVxdWFsc0VsZW1lbnQoXG4gIGlucHV0OiBFcXVhbHNFbGVtZW50LFxuICB0YWdOYW1lOiBzdHJpbmcsXG4gIGF0dHJpYnV0ZXM6IERpY3QsXG4gIGNvbnRlbnQ6IHN0cmluZyB8IG51bGxcbikge1xuICBsZXQgeyBlbGVtZW50LCBkZXNjcmlwdGlvbiB9ID0gZXh0cmFjdChpbnB1dCk7XG5cbiAgaWYgKGVsZW1lbnQgPT09IG51bGwpIHtcbiAgICBRVW5pdC5hc3NlcnQucHVzaFJlc3VsdCh7XG4gICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgYWN0dWFsOiBlbGVtZW50LFxuICAgICAgZXhwZWN0ZWQ6IHRydWUsXG4gICAgICBtZXNzYWdlOiBgZmFpbGVkIC0gZXhwZWN0ZWQgJHtkZXNjcmlwdGlvbn0gdG8gbm90IGJlIG51bGxgLFxuICAgIH0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIFFVbml0LmFzc2VydC5wdXNoUmVzdWx0KHtcbiAgICByZXN1bHQ6IGVsZW1lbnQudGFnTmFtZSA9PT0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpLFxuICAgIGFjdHVhbDogZWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCksXG4gICAgZXhwZWN0ZWQ6IHRhZ05hbWUsXG4gICAgbWVzc2FnZTogYGV4cGVjdCAke2Rlc2NyaXB0aW9ufSdzIHRhZ05hbWUgdG8gYmUgJHt0YWdOYW1lfWAsXG4gIH0pO1xuXG4gIGxldCBleHBlY3RlZEF0dHJzOiBEaWN0PE1hdGNoZXI+ID0gZGljdDxNYXRjaGVyPigpO1xuXG4gIGxldCBleHBlY3RlZENvdW50ID0gMDtcbiAgZm9yIChsZXQgcHJvcCBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgZXhwZWN0ZWRDb3VudCsrO1xuICAgIGxldCBleHBlY3RlZCA9IGF0dHJpYnV0ZXNbcHJvcF07XG5cbiAgICBsZXQgbWF0Y2hlcjogTWF0Y2hlciA9IGlzTWF0Y2hlcihleHBlY3RlZCkgPyBleHBlY3RlZCA6IGVxdWFsc0F0dHIoZXhwZWN0ZWQpO1xuICAgIGV4cGVjdGVkQXR0cnNbcHJvcF0gPSBtYXRjaGVyO1xuXG4gICAgUVVuaXQuYXNzZXJ0LnB1c2hSZXN1bHQoe1xuICAgICAgcmVzdWx0OiBleHBlY3RlZEF0dHJzW3Byb3BdLm1hdGNoKGVsZW1lbnQgJiYgZWxlbWVudC5nZXRBdHRyaWJ1dGUocHJvcCkpLFxuICAgICAgYWN0dWFsOiBtYXRjaGVyLmZhaWwoZWxlbWVudCAmJiBlbGVtZW50LmdldEF0dHJpYnV0ZShwcm9wKSksXG4gICAgICBleHBlY3RlZDogbWF0Y2hlci5mYWlsKGVsZW1lbnQgJiYgZWxlbWVudC5nZXRBdHRyaWJ1dGUocHJvcCkpLFxuICAgICAgbWVzc2FnZTogYEV4cGVjdGVkICR7ZGVzY3JpcHRpb259J3MgJHtwcm9wfSBhdHRyaWJ1dGUgJHttYXRjaGVyLmV4cGVjdGVkKCl9YCxcbiAgICB9KTtcbiAgfVxuXG4gIGxldCBhY3R1YWxBdHRyaWJ1dGVzID0gZGljdCgpO1xuICBpZiAoZWxlbWVudCkge1xuICAgIGZvciAobGV0IGkgPSAwLCBsID0gZWxlbWVudC5hdHRyaWJ1dGVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgYWN0dWFsQXR0cmlidXRlc1tlbGVtZW50LmF0dHJpYnV0ZXNbaV0ubmFtZV0gPSBlbGVtZW50LmF0dHJpYnV0ZXNbaV0udmFsdWU7XG4gICAgfVxuICB9XG5cbiAgaWYgKCEoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkge1xuICAgIFFVbml0LmFzc2VydC5wdXNoUmVzdWx0KHtcbiAgICAgIHJlc3VsdDogZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50LFxuICAgICAgYWN0dWFsOiBudWxsLFxuICAgICAgZXhwZWN0ZWQ6IG51bGwsXG4gICAgICBtZXNzYWdlOiAnRWxlbWVudCBtdXN0IGJlIGFuIEhUTUwgRWxlbWVudCwgbm90IGFuIFNWRyBFbGVtZW50JyxcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBRVW5pdC5hc3NlcnQucHVzaFJlc3VsdCh7XG4gICAgICByZXN1bHQ6IGVsZW1lbnQuYXR0cmlidXRlcy5sZW5ndGggPT09IGV4cGVjdGVkQ291bnQsXG4gICAgICBhY3R1YWw6IGVsZW1lbnQuYXR0cmlidXRlcy5sZW5ndGgsXG4gICAgICBleHBlY3RlZDogZXhwZWN0ZWRDb3VudCxcbiAgICAgIG1lc3NhZ2U6IGBFeHBlY3RlZCAke2V4cGVjdGVkQ291bnR9IGF0dHJpYnV0ZXM7IGdvdCAke2VsZW1lbnQub3V0ZXJIVE1MfWAsXG4gICAgfSk7XG5cbiAgICBpZiAoY29udGVudCAhPT0gbnVsbCkge1xuICAgICAgUVVuaXQuYXNzZXJ0LnB1c2hSZXN1bHQoe1xuICAgICAgICByZXN1bHQ6IGVsZW1lbnQuaW5uZXJIVE1MID09PSBjb250ZW50LFxuICAgICAgICBhY3R1YWw6IGVsZW1lbnQuaW5uZXJIVE1MLFxuICAgICAgICBleHBlY3RlZDogY29udGVudCxcbiAgICAgICAgbWVzc2FnZTogYCR7ZGVzY3JpcHRpb259IGhhZCAnJHtjb250ZW50fScgYXMgaXRzIGNvbnRlbnRgLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG5cbi8vIFRPRE86IENvbnNpZGVyIHJlbW92aW5nIHRoaXNcbmludGVyZmFjZSBDb21wYXRpYmxlVGFnTmFtZU1hcCBleHRlbmRzIEVsZW1lbnRUYWdOYW1lTWFwIHtcbiAgZm9yZWlnbm9iamVjdDogU1ZHRm9yZWlnbk9iamVjdEVsZW1lbnQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRJc0VsZW1lbnQobm9kZTogU2ltcGxlTm9kZSB8IG51bGwpOiBub2RlIGlzIFNpbXBsZUVsZW1lbnQge1xuICBsZXQgbm9kZVR5cGUgPSBub2RlID09PSBudWxsID8gbnVsbCA6IG5vZGUubm9kZVR5cGU7XG4gIFFVbml0LmFzc2VydC5wdXNoUmVzdWx0KHtcbiAgICByZXN1bHQ6IG5vZGVUeXBlID09PSAxLFxuICAgIGV4cGVjdGVkOiAxLFxuICAgIGFjdHVhbDogbm9kZVR5cGUsXG4gICAgbWVzc2FnZTogJ2V4cGVjdGVkIG5vZGUgdG8gYmUgYW4gZWxlbWVudCcsXG4gIH0pO1xuICByZXR1cm4gbm9kZVR5cGUgPT09IDE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnROb2RlVGFnTmFtZTxcbiAgVCBleHRlbmRzIGtleW9mIENvbXBhdGlibGVUYWdOYW1lTWFwLFxuICBVIGV4dGVuZHMgQ29tcGF0aWJsZVRhZ05hbWVNYXBbVF1cbj4obm9kZTogU2ltcGxlTm9kZSB8IG51bGwsIHRhZ05hbWU6IFQpOiBub2RlIGlzIFNpbXBsZU5vZGUgJiBVIHtcbiAgaWYgKGFzc2VydElzRWxlbWVudChub2RlKSkge1xuICAgIGNvbnN0IGxvd2VyVGFnTmFtZSA9IG5vZGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIGNvbnN0IG5vZGVUYWdOYW1lID0gbm9kZS50YWdOYW1lO1xuXG4gICAgUVVuaXQuYXNzZXJ0LnB1c2hSZXN1bHQoe1xuICAgICAgcmVzdWx0OiBsb3dlclRhZ05hbWUgPT09IHRhZ05hbWUgfHwgbm9kZVRhZ05hbWUgPT09IHRhZ05hbWUsXG4gICAgICBleHBlY3RlZDogdGFnTmFtZSxcbiAgICAgIGFjdHVhbDogbm9kZVRhZ05hbWUsXG4gICAgICBtZXNzYWdlOiBgZXhwZWN0ZWQgdGFnTmFtZSB0byBiZSAke3RhZ05hbWV9IGJ1dCB3YXMgJHtub2RlVGFnTmFtZX1gLFxuICAgIH0pO1xuICAgIHJldHVybiBub2RlVGFnTmFtZSA9PT0gdGFnTmFtZSB8fCBsb3dlclRhZ05hbWUgPT09IHRhZ05hbWU7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXF1YWxzQXR0cihleHBlY3RlZDogYW55KTogTWF0Y2hlciB7XG4gIHJldHVybiB7XG4gICAgJzNkNGVmMTk0LTEzYmUtNGNjZi04ZGM3LTg2MmVlYTAyYzkzZSc6IHRydWUsXG4gICAgbWF0Y2goYWN0dWFsOiBhbnkpIHtcbiAgICAgIHJldHVybiBleHBlY3RlZCA9PT0gYWN0dWFsO1xuICAgIH0sXG5cbiAgICBleHBlY3RlZCgpIHtcbiAgICAgIHJldHVybiBgdG8gZXF1YWwgJHtleHBlY3RlZH1gO1xuICAgIH0sXG5cbiAgICBmYWlsKGFjdHVhbDogYW55KSB7XG4gICAgICByZXR1cm4gYCR7YWN0dWFsfSBkaWQgbm90IGVxdWFsICR7ZXhwZWN0ZWR9YDtcbiAgICB9LFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RW1iZXJpc2hFbGVtZW50KFxuICBlbGVtZW50OiBTaW1wbGVFbGVtZW50LFxuICB0YWdOYW1lOiBzdHJpbmcsXG4gIGF0dHJzOiBPYmplY3QsXG4gIGNvbnRlbnRzOiBzdHJpbmdcbik6IHZvaWQ7XG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RW1iZXJpc2hFbGVtZW50KGVsZW1lbnQ6IFNpbXBsZUVsZW1lbnQsIHRhZ05hbWU6IHN0cmluZywgYXR0cnM6IE9iamVjdCk6IHZvaWQ7XG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RW1iZXJpc2hFbGVtZW50KFxuICBlbGVtZW50OiBTaW1wbGVFbGVtZW50LFxuICB0YWdOYW1lOiBzdHJpbmcsXG4gIGNvbnRlbnRzOiBzdHJpbmdcbik6IHZvaWQ7XG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RW1iZXJpc2hFbGVtZW50KGVsZW1lbnQ6IFNpbXBsZUVsZW1lbnQsIHRhZ05hbWU6IHN0cmluZyk6IHZvaWQ7XG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RW1iZXJpc2hFbGVtZW50KC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gIGxldCBbZWxlbWVudCwgdGFnTmFtZSwgYXR0cnMsIGNvbnRlbnRzXSA9IHByb2Nlc3NBc3NlcnRFbGVtZW50QXJncyhhcmdzKTtcblxuICBsZXQgZnVsbEF0dHJzID0gYXNzaWduKHsgY2xhc3M6IGNsYXNzZXMoJ2VtYmVyLXZpZXcnKSwgaWQ6IHJlZ2V4KC9eZW1iZXJcXGQqJC8pIH0sIGF0dHJzKTtcblxuICBlcXVhbHNFbGVtZW50KGVsZW1lbnQsIHRhZ05hbWUsIGZ1bGxBdHRycywgY29udGVudHMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0U2VyaWFsaXplZEluRWxlbWVudChyZXN1bHQ6IHN0cmluZywgZXhwZWN0ZWQ6IHN0cmluZywgbWVzc2FnZT86IHN0cmluZykge1xuICBsZXQgbWF0Y2hlZCA9IHJlc3VsdC5tYXRjaCgvPHNjcmlwdCBnbG1yPVwiJWN1cnNvcjpbMC05XSouJVwiPjxcXC9zY3JpcHQ+Lyk7XG5cbiAgaWYgKG1hdGNoZWQpIHtcbiAgICBRVW5pdC5hc3NlcnQub2sodHJ1ZSwgYGhhcyBjdXJzb3IgJHttYXRjaGVkWzBdfWApO1xuICAgIGxldCBbLCB0cmltbWVkXSA9IHJlc3VsdC5zcGxpdChtYXRjaGVkIVswXSk7XG4gICAgUVVuaXQuYXNzZXJ0LmVxdWFsKHRyaW1tZWQsIGV4cGVjdGVkLCBtZXNzYWdlKTtcbiAgfSBlbHNlIHtcbiAgICBRVW5pdC5hc3NlcnQub2soZmFsc2UsIGBkb2VzIG5vdCBoYXZlIGEgY3Vyc29yYCk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsYXNzZXMoZXhwZWN0ZWQ6IHN0cmluZykge1xuICByZXR1cm4ge1xuICAgICczZDRlZjE5NC0xM2JlLTRjY2YtOGRjNy04NjJlZWEwMmM5M2UnOiB0cnVlLFxuICAgIG1hdGNoKGFjdHVhbDogc3RyaW5nKSB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICBhY3R1YWwgJiZcbiAgICAgICAgZXhwZWN0ZWRcbiAgICAgICAgICAuc3BsaXQoJyAnKVxuICAgICAgICAgIC5zb3J0KClcbiAgICAgICAgICAuam9pbignICcpID09PVxuICAgICAgICAgIGFjdHVhbFxuICAgICAgICAgICAgLnNwbGl0KCcgJylcbiAgICAgICAgICAgIC5zb3J0KClcbiAgICAgICAgICAgIC5qb2luKCcgJylcbiAgICAgICk7XG4gICAgfSxcbiAgICBleHBlY3RlZCgpIHtcbiAgICAgIHJldHVybiBgdG8gaW5jbHVkZSAnJHtleHBlY3RlZH0nYDtcbiAgICB9LFxuICAgIGZhaWwoYWN0dWFsOiBzdHJpbmcpIHtcbiAgICAgIHJldHVybiBgJyR7YWN0dWFsfScnIGRpZCBub3QgbWF0Y2ggJyR7ZXhwZWN0ZWR9J2A7XG4gICAgfSxcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2V4KHI6IFJlZ0V4cCkge1xuICByZXR1cm4ge1xuICAgICczZDRlZjE5NC0xM2JlLTRjY2YtOGRjNy04NjJlZWEwMmM5M2UnOiB0cnVlLFxuICAgIG1hdGNoKHY6IHN0cmluZykge1xuICAgICAgcmV0dXJuIHIudGVzdCh2KTtcbiAgICB9LFxuICAgIGV4cGVjdGVkKCkge1xuICAgICAgcmV0dXJuIGB0byBtYXRjaCAke3J9YDtcbiAgICB9LFxuICAgIGZhaWwoYWN0dWFsOiBzdHJpbmcpIHtcbiAgICAgIHJldHVybiBgJHthY3R1YWx9IGRpZCBub3QgbWF0Y2ggJHtyfWA7XG4gICAgfSxcbiAgfTtcbn1cblxuaW50ZXJmYWNlIE1hdGNoZXIge1xuICAnM2Q0ZWYxOTQtMTNiZS00Y2NmLThkYzctODYyZWVhMDJjOTNlJzogYm9vbGVhbjtcbiAgbWF0Y2goYWN0dWFsOiBhbnkpOiBib29sZWFuO1xuICBmYWlsKGFjdHVhbDogYW55KTogc3RyaW5nO1xuICBleHBlY3RlZCgpOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjb25zdCBNQVRDSEVSID0gJzNkNGVmMTk0LTEzYmUtNGNjZi04ZGM3LTg2MmVlYTAyYzkzZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc01hdGNoZXIoaW5wdXQ6IHVua25vd24pOiBpbnB1dCBpcyBNYXRjaGVyIHtcbiAgaWYgKHR5cGVvZiBpbnB1dCAhPT0gJ29iamVjdCcgfHwgaW5wdXQgPT09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIE1BVENIRVIgaW4gaW5wdXQ7XG59XG5cbi8qKlxuICBBY2NvbW9kYXRlcyB0aGUgdmFyaW91cyBzaWduYXR1cmVzIG9mIGBhc3NlcnRFbWJlcmlzaEVsZW1lbnRgIGFuZCBgYXNzZXJ0RWxlbWVudGAsIHdoaWNoIGNhbiBiZSBhbnkgb2Y6XG5cbiAgLSBlbGVtZW50LCB0YWdOYW1lLCBhdHRycywgY29udGVudHNcbiAgLSBlbGVtZW50LCB0YWdOYW1lLCBjb250ZW50c1xuICAtIGVsZW1lbnQsIHRhZ05hbWUsIGF0dHJzXG4gIC0gZWxlbWVudCwgdGFnTmFtZVxuXG4gIFRPRE86IGZ1dHVyZSByZWZhY3RvcmluZ3Mgc2hvdWxkIGNsZWFuIHVwIHRoaXMgaW50ZXJmYWNlIChsaWtlbHkganVzdCBtYWtpbmcgYWxsIGNhbGxlcnMgcGFzcyBhIFBPSk8pXG4qL1xuZXhwb3J0IGZ1bmN0aW9uIHByb2Nlc3NBc3NlcnRFbGVtZW50QXJncyhhcmdzOiBhbnlbXSk6IFtTaW1wbGVFbGVtZW50LCBzdHJpbmcsIGFueSwgc3RyaW5nIHwgbnVsbF0ge1xuICBsZXQgZWxlbWVudCA9IGFyZ3NbMF07XG5cbiAgaWYgKGFyZ3MubGVuZ3RoID09PSAzKSB7XG4gICAgaWYgKHR5cGVvZiBhcmdzWzJdID09PSAnc3RyaW5nJykgcmV0dXJuIFtlbGVtZW50LCBhcmdzWzFdLCB7fSwgYXJnc1syXV07XG4gICAgZWxzZSByZXR1cm4gW2VsZW1lbnQsIGFyZ3NbMV0sIGFyZ3NbMl0sIG51bGxdO1xuICB9IGVsc2UgaWYgKGFyZ3MubGVuZ3RoID09PSAyKSB7XG4gICAgcmV0dXJuIFtlbGVtZW50LCBhcmdzWzFdLCB7fSwgbnVsbF07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIFthcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdXTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RWxlbWVudFNoYXBlKFxuICBlbGVtZW50OiBTaW1wbGVFbGVtZW50LFxuICB0YWdOYW1lOiBzdHJpbmcsXG4gIGF0dHJzOiBPYmplY3QsXG4gIGNvbnRlbnRzOiBzdHJpbmdcbik6IHZvaWQ7XG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RWxlbWVudFNoYXBlKGVsZW1lbnQ6IFNpbXBsZUVsZW1lbnQsIHRhZ05hbWU6IHN0cmluZywgYXR0cnM6IE9iamVjdCk6IHZvaWQ7XG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RWxlbWVudFNoYXBlKGVsZW1lbnQ6IFNpbXBsZUVsZW1lbnQsIHRhZ05hbWU6IHN0cmluZywgY29udGVudHM6IHN0cmluZyk6IHZvaWQ7XG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RWxlbWVudFNoYXBlKGVsZW1lbnQ6IFNpbXBsZUVsZW1lbnQsIHRhZ05hbWU6IHN0cmluZyk6IHZvaWQ7XG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RWxlbWVudFNoYXBlKC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gIGxldCBbZWxlbWVudCwgdGFnTmFtZSwgYXR0cnMsIGNvbnRlbnRzXSA9IHByb2Nlc3NBc3NlcnRFbGVtZW50QXJncyhhcmdzKTtcblxuICBlcXVhbHNFbGVtZW50KGVsZW1lbnQsIHRhZ05hbWUsIGF0dHJzLCBjb250ZW50cyk7XG59XG4iXX0=